# 관계

## 관계(relationship)의 개념
- 관계는 `엔티티 간의 연관성`을 나타낸 개념이다.
- 관계를 정의할 때는 인스턴스(각 행 데이터) 간의 논리적인 연관성을 파악하여 정의한다.
- 엔티티를 어떻게 정의하느냐에 따라 변경되기도 한다.
- ex) 강사 - 가르친다(관계) - 수강생

<p>

## 관계의 종류
1. 존재적 관계
   - 한 엔티티의 존재가 다른 엔티티의 존재에 영향을 미치는 경우(관계)
   - 엔티티 간의 연관된 상태를 의미한다.
   - ex) 부서 엔티티가 삭제되면 사원 엔티티의 존재에 영향을 미친다.
2. 행위적 관계
   - 엔티티 간의 어떤 행위가 있는 것을 의미
   - ex) 고객 엔티티의 행동에 의해 주문 엔티티가 발생한다.

> ERD에서는 존재 관계와 행위 관계를 구분하지 않는다.
</p>

<p>

## 관계의 구성
1. 관계명
   - 관계의 이름
   - 애매한 동사 표현(x), 현재형 표현(o)
   - ex) 포함한다/소속된다
2. 차수(Cardinality)
   - 1:1, 1:N, N:M
3. 선택성(Optionality)
   - 필수관계 : 참여하는 모든 엔티티가 항상 참여한다. 
     - ex) 주문서와 주문목록의 관계
   - 선택관계 : ex) 쇼핑 카트와 주문 목록의 관계
</p>

<p>

## 관계의 차수(Cardinality)
- 한 엔티티의 레코드(인스턴스)가 다른 엔티티의 레코드(인스턴스)와 어떻게 `연결`되는지를 나타내는 표현
- 주로 1:1, 1:N, N:M 등으로 표현

### 1) 1 대 1 관계
- 완전 1 대 1 관계
  - 하나의 엔티티에 관계되는 엔티티가 반드시 존재하는 경우
  - ex) 사원은 반드시 소속 부서가 있어야 함.
- 선택적 1 대 1 관계
  - 하나의 엔티티에 관계되는 엔티티가 하나이거나 없을 수 있는 경우
  - ex) 사원은 하나의 소속 부서가 있거나 아직 발령 전이면 없을 수 있음.

### 2) 1 대 N 관계
- 엔티티에 하나의 행에 다른 엔티티의 값이 여러 개 있는 관계
- ex) 고객은 여러 개의 계좌를 소유할 수 있음.

### 3) N 대 M 관계
- 두 엔티티가 다대다 연결 관계를 가지고 있음.
- 이 경우 조인 시 `카테시안 곱`이 발생하므로, 두 엔티티를 연결하는 `연결 엔티티`를 추가로 1대N 관계를 해소할 필요가 있음.
- ex) 한 학생이 여러 강의를 수강할 수 있고, 한 강의 기준으로 여러 학생이 보유할 수 있음.
  -> 이 두 엔티티를 연결 엔티티로는 구매이력 엔티티가 필요함.
</p>

<p>

## 관계의 페어링
- 엔티티 안에 `인스턴스`가 개별적으로 관계를 가지는 것
- 관계란 `페어링의 집합`을 의미
</p>

<p>

## 관계와 차수, 페어링의 차이
- 학생과 강의 엔티티는 관계를 가짐
- 한 학생은 여러 강의를 수강할 수 있고, 한 강의로 여러 학생에게 수강될 수 있으므로
  N대 M 관계로 차수는 N:M이 된다.
- 인스턴스의 관계를 보면 "학생 A가 강의를 B를 2023년 1학기에 수강했고, 성적은 A+를 받았다" 와 같은 특정 페어링 형성
- 이런식으로 관계의 `차수`는 하나의 엔티티와 다른 엔티티 간의 `레코드 연결 방식`을 나타내는 반면
  `페어링`은 `두 엔티티 간의 특정 연결을 설명`하고 추가적인 정보를 제공하는 용도로 사용한다.
</p>

<p>

## UML(통합모델링언어)에서의 관계
- 연관관계(실선) : 항상 이용하는 관계(존재적) -> ex) 소속된다.
- 의존관계(점선) : `상대 행위`에 의해 발생하는 관계 -> ex) 주문한다. 

> <ERD와의 차이점>  
> ERD는 `존재/행위`에 의한 관계 구분을 하지 않는다. `식별/비식별`로 구분한다.

</p>

<p>

## 관계의 체크사항
1. 2개의 엔티티 사이에 관심있는 `연관 규칙`이 있는가?
2. 2개의 엔티티 사이에 `정보의 조합` 발생하였는가?
3. 업무기술서, 장표에 관계 연결에 대한 `규칙`이 서술되었는가?
4. 업무기술서, 장표에 관계 연결을 가능케 하는 `동사`가 존재하는가?
</p>